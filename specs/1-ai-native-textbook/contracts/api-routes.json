{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "FastAPI Routes",
  "description": "Schema for documenting FastAPI backend API endpoints.",
  "type": "object",
  "properties": {
    "/api/auth/signup": {
      "type": "object",
      "description": "User registration endpoint.",
      "properties": {
        "method": { "type": "string", "enum": ["POST"] },
        "request_body": { "$ref": "#/definitions/UserSignupRequest" },
        "responses": { "201": { "$ref": "#/definitions/UserResponse" } }
      }
    },
    "/api/auth/login": { "type": "object", "description": "User login endpoint.", "properties": { "method": { "type": "string", "enum": ["POST"] }, "request_body": { "$ref": "#/definitions/UserLoginRequest" }, "responses": { "200": { "$ref": "#/definitions/UserResponse" } } } },
    "/api/user/profile": {
      "type": "object",
      "description": "Retrieve or update user profile.",
      "properties": {
        "method": { "type": "string", "enum": ["GET", "PUT"] },
        "responses": { "200": { "$ref": "#/definitions/UserProfileResponse" } }
      }
    },
    "/api/chapter/{chapter_id}/personalize": {
      "type": "object",
      "description": "Personalize chapter content based on user profile.",
      "properties": {
        "method": { "type": "string", "enum": ["POST"] },
        "parameters": {
          "chapter_id": { "type": "string", "format": "uuid" }
        },
        "request_body": { "type": "object", "properties": { "content": { "type": "string" } } },
        "responses": { "200": { "type": "object", "properties": { "personalized_content": { "type": "string" } } } }
      }
    },
    "/api/chapter/{chapter_id}/translate": {
      "type": "object",
      "description": "Translate chapter content to a target language (e.g., Urdu).",
      "properties": {
        "method": { "type": "string", "enum": ["POST"] },
        "parameters": {
          "chapter_id": { "type": "string", "format": "uuid" }
        },
        "request_body": { "type": "object", "properties": { "content": { "type": "string" }, "target_language": { "type": "string" } } },
        "responses": { "200": { "type": "object", "properties": { "translated_content": { "type": "string" } } } }
      }
    },
    "/api/chatbot/query": {
      "type": "object",
      "description": "RAG chatbot query endpoint, constrained to selected text.",
      "properties": {
        "method": { "type": "string", "enum": ["POST"] },
        "request_body": { "$ref": "#/definitions/ChatbotQueryRequest" },
        "responses": { "200": { "$ref": "#/definitions/ChatbotResponse" } }
      }
    },
    "/api/subagent/{agent_name}/execute": {
      "type": "object",
      "description": "Execute a Claude Code subagent (quiz, summary, diagram explainer).",
      "properties": {
        "method": { "type": "string", "enum": ["POST"] },
        "parameters": {
          "agent_name": { "type": "string" }
        },
        "request_body": { "type": "object", "properties": { "content": { "type": "string" }, "parameters": { "type": "object" } } },
        "responses": { "200": { "type": "object", "properties": { "result": { "type": "string" } } } }
      }
    }
  },
  "definitions": {
    "UserSignupRequest": {
      "type": "object",
      "required": ["email", "password"],
      "properties": {
        "email": { "type": "string", "format": "email" },
        "password": { "type": "string", "minLength": 8 }
      }
    },
    "UserLoginRequest": {
      "type": "object",
      "required": ["email", "password"],
      "properties": {
        "email": { "type": "string", "format": "email" },
        "password": { "type": "string" }
      }
    },
    "UserResponse": {
      "type": "object",
      "properties": {
        "user_id": { "type": "string", "format": "uuid" },
        "email": { "type": "string", "format": "email" }
      }
    },
    "UserProfileResponse": {
      "type": "object",
      "properties": {
        "user_id": { "type": "string", "format": "uuid" },
        "name": { "type": "string" },
        "software_background": { "type": "string" },
        "hardware_background": { "type": "string" },
        "learning_pace_preference": { "type": "string" },
        "preferred_language": { "type": "string" },
        "personalized_content_difficulty": { "type": "string" }
      }
    },
    "ChatbotQueryRequest": {
      "type": "object",
      "required": ["query", "selected_text"],
      "properties": {
        "query": { "type": "string" },
        "selected_text": { "type": "string", "description": "The text selected by the user, for RAG context." }
      }
    },
    "ChatbotResponse": {
      "type": "object",
      "properties": {
        "answer": { "type": "string" },
        "sources": { "type": "array", "items": { "type": "string" } }
      }
    }
  }
}